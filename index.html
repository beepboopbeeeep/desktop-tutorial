<input id="domain" placeholder="Ø¯Ø§Ù…Ù†Ù‡â€ŒØ§ÛŒ Ù…Ø«Ù„ example.com" />
<button onclick="testIP()">ØªØ³Øª Ø¢ÛŒâ€ŒÙ¾ÛŒ Ù†ÙˆØ¯ Ú©Ù„Ø§Ø¯ÙÙ„Ø±</button>
<pre id="output">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±...</pre>

<script>
  async function testIP() {
    const dom = document.getElementById("domain").value.trim();
    const proxyURL = `https://cfipscanner.nedorir.workers.dev/?domain=${dom}`;
    document.getElementById("output").textContent = "ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢ÛŒâ€ŒÙ¾ÛŒ...";

    try {
      const res = await fetch(proxyURL);
      const data = await res.json();
      const ips = data.Answer?.filter(r => r.type === 1).map(r => r.data) || [];

      if (!ips.length) {
        document.getElementById("output").textContent = "â›” Ø¢ÛŒâ€ŒÙ¾ÛŒ Ú©Ù„Ø§Ø¯ÙÙ„Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.";
        return;
      }

      let result = `ğŸŒ Ø¯Ø§Ù…Ù†Ù‡: ${dom}\n`;
      for (const ip of ips) {
        const start = performance.now();
        try {
          await fetch(`https://${ip}/cdn-cgi/trace`, { mode: "no-cors" });
          const latency = Math.round(performance.now() - start);
          result += `âœ… Ø¢ÛŒâ€ŒÙ¾ÛŒ ${ip} - latency ØªÙ‚Ø±ÛŒØ¨ÛŒ: ${latency} ms\n`;
        } catch {
          result += `âŒ Ø¢ÛŒâ€ŒÙ¾ÛŒ ${ip} - Ù¾Ø§Ø³Ø® Ù†Ø¯Ø§Ø¯\n`;
        }
      }

      document.getElementById("output").textContent = result;
    } catch (err) {
      document.getElementById("output").textContent = "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÛŒØ§ ØªØ³Øª Ø¢ÛŒâ€ŒÙ¾ÛŒ.";
    }
  }
</script>
