<input id="domain" placeholder="Ù…Ø«Ù„Ø§Ù‹: speed.cloudflare.com" />
<button onclick="testDomain()">ØªØ³Øª Ø¢ÛŒâ€ŒÙ¾ÛŒ</button>
<pre id="result">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ÙˆØ±ÙˆØ¯ÛŒ...</pre>

<script>
  async function testDomain() {
    const dom = document.getElementById("domain").value.trim();
    if (!dom) return;

    document.getElementById("result").textContent = "Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢ÛŒâ€ŒÙ¾ÛŒ Ø§Ø² DNS...";

    const dnsURL = `https://cloudflare-dns.com/dns-query?name=${dom}&type=A`;
    try {
      const dnsRes = await fetch(dnsURL, { headers: { accept: "application/dns-json" } });
      const dnsJson = await dnsRes.json();
      const ips = dnsJson.Answer?.filter(r => r.type === 1).map(r => r.data) || [];

      if (ips.length === 0) {
        document.getElementById("result").textContent = "â›” Ø¢ÛŒâ€ŒÙ¾ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.";
        return;
      }

      let resultText = `ğŸŒ Ø¯Ø§Ù…Ù†Ù‡: ${dom}\nğŸ” Ø¢ÛŒâ€ŒÙ¾ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ø³Ø®Ú¯Ùˆ:\n`;

      for (const ip of ips) {
        const url = `https://${ip}/cdn-cgi/trace`;
        const start = performance.now();
        try {
          const pingRes = await fetch(url, { method: "GET", mode: "no-cors" });
          const latency = Math.round(performance.now() - start);
          resultText += `âœ… ${ip} - latency ~ ${latency} ms\n`;
        } catch {
          resultText += `âŒ ${ip} - Ù¾Ø§Ø³Ø® Ù†Ø¯Ø§Ø¯\n`;
        }
      }

      document.getElementById("result").textContent = resultText;
    } catch (err) {
      document.getElementById("result").textContent = "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª DNS ÛŒØ§ ØªØ³Øª Ø¢ÛŒâ€ŒÙ¾ÛŒ.";
    }
  }
</script>
